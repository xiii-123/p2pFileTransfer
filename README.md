# p2pFileTransfer

## 背景
EthosNet是一个基于区块链的去中心化存储网络，用户在区块链上存储文件Hash等元信息，并在链下进行点对点文件传输。
p2pFileTransfer是EthosNet的一个子模块，负责实现分布式文件传输。

## 角色定义
- 用户：上传文件的用户
- 存储节点：按照一定规则实际存储文件块并提交**存储证明**的节点
- 轻节点：只存储感兴趣的文件，不提交存储证明的节点

## 过程

### 上传文件
用户向网络中上传文件时，首先会将文件按照一定大小分割成一个个块，然后生成文件元数据，包括：
- 文件名
- 文件描述
- 文件大小
- 文件Hash
- 块信息
  - 块大小
  - 块hash

随后，用户将文件元信息装入交易并发送到链上。

### 存储节点获取文件块
存储节点按照一定的规则（基于激励机制）从上传文件的节点哪里获取若干文件块。
存储节点需要定时上传存储证明到链上，证明自己存储了文件块。

### 节点获取文件
任意节点均可从链上获取文件元信息，并且查找实际存储了文件块的存储节点，从他们哪里获取文件块并组织成为完整文件。